# rsyslog configuration file

# For more information see /usr/share/doc/rsyslog-*/rsyslog_conf.html
# or latest version online at http://www.rsyslog.com/doc/rsyslog_conf.html 
# If you experience problems, see http://www.rsyslog.com/doc/troubleshoot.html

#### GLOBAL DIRECTIVES ####

# Where to place auxiliary files
global(workDirectory="/var/lib/rsyslog")

module(load="omprog")

$ModLoad imudp
$UDPServerRun 514


template(name="fotospeed-ui-lr" type="list") {
  constant(value="{\"application\":\"")       property(name="programname")
  constant(value="\",\"message\":\"")         property(name="msg" format="json")
  constant(value="\",\"unixtime\":")          property(name="timegenerated" dateformat="unixtimestamp")
  constant(value="}\n")
}

action(
  type="omprog"
  binary="/opt/pyrsyslogredis/venv/bin/python3 /opt/pyrsyslogredis/py-rsyslog-redis/pyrsyslogredis/__init__.py"
  output="/tmp/pyrsyslogredis.log"
  confirmMessages="on"
  template="fotospeed-ui-lr"
)
